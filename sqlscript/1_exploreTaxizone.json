{
	"name": "1_exploreTaxizone",
	"properties": {
		"folder": {
			"name": "nyc_taxi/Discovery"
		},
		"content": {
			"query": "-- This is auto-generated code\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n    ) AS [result]\n\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'abfss://nyc-taxi-data@bmksynapsedemodl.dfs.core.windows.net/raw/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS [result]\n\n-------------------------------------------------------------------\n--Examine the Datatypes for the columns\n-- check current DB\n\nEXEC sp_describe_first_result_set N'SELECT\n     *\nFROM\n    OPENROWSET(\n        BULK ''https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone.csv'',\n        FORMAT = ''CSV'',\n        PARSER_VERSION = ''2.0'',\n        HEADER_ROW = TRUE\n      )AS [result]'\n\n------------------------------------------------\n\nSELECT\n    MAX(LEN(LocationID)) as Len_locationid,\n    MAX(Len(Borough)) as Len_Borough,\n    MAX(len(Zone)) as Zone,\n    MAX(len(service_zone)) as Len_service_zone\nFROM\n    OPENROWSET(\n        BULK 'abfss://nyc-taxi-data@bmksynapsedemodl.dfs.core.windows.net/raw/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) AS [result]\n\n--- use with clause to provide explict datatypes-----------\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n    ) \n    with (\n        LocationID SMALLINT,\n        Borough VARCHAR(15),\n        Zone VARCHAR(50),\n        service_zone VARCHAR(15)\n    )AS [result]\n\n---------------------------------------------------------------------------------\nEXEC sp_describe_first_result_set N'SELECT\n     *\nFROM\n    OPENROWSET(\n        BULK ''https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone.csv'',\n        FORMAT = ''CSV'',\n        PARSER_VERSION = ''2.0'',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR = '','',\n        ROWTERMINATOR = ''\\n''\n    ) \n    with (\n        LocationID SMALLINT,\n        Borough VARCHAR(15),\n        Zone VARCHAR(50),\n        service_zone VARCHAR(15)\n    )AS [result]'\n\n------------------------------------------------------------------------------------------------------\nSELECT name, collation_name from sys.databases\n-------------------------------------------------------------------------------------------------------------\n--specify utf8 collation  \nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n    ) \n    with (\n        LocationID SMALLINT,\n        Borough VARCHAR(15) COLLATE Latin1_General_100_CI_AI_SC_UTF8,\n        Zone VARCHAR(50) COLLATE Latin1_General_100_CI_AI_SC_UTF8,\n        service_zone VARCHAR(15) COLLATE Latin1_General_100_CI_AI_SC_UTF8\n    )AS [result]\n------------------------------------------------------------------------\nCREATE DATABASE nyc_taxi_discovery\nCOLLATE Latin1_General_100_CI_AI_SC_UTF8;\n\nuse nyc_taxi_discovery\n\nSELECT name, collation_name from sys.databases\n\n-------------------------------------------------------------\n--select only subset of columns\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n    ) \n    with (\n        Borough VARCHAR(15),\n        Zone VARCHAR(50)\n       \n    )AS [result]\n\n---------------\n\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone_without_header.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n)\nWITH(\n    LocationID SMALLINT,\n        Borough VARCHAR(15),\n        Zone VARCHAR(50),\n        service_zone VARCHAR(15)\n    ) AS [result]\n-------------------------\n---if we define like this subset of columns it takes blindly from starting directly--------------------\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone_without_header.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n)\nWITH(\n        Borough VARCHAR(15),\n        Zone VARCHAR(50)       \n    ) AS [result]\n--correct way of defining subset of column \nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone_without_header.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n)\nWITH(\n        Borough VARCHAR(15) 2,\n        Zone VARCHAR(50) 3\n) AS [result]\n---- we can get any columnal order by puting it in the with statement like zone first and borough second and \n--even change the name of the columns like from line 206 ---\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone_without_header.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n)\nWITH(\n        Zone VARCHAR(50) 3,\n        Borough VARCHAR(15) 2\n) AS [result]\n------+ i took the previous file here which have header using firstrow keyword without specifing header as true ------\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'https://bmksynapsedemodl.dfs.core.windows.net/nyc-taxi-data/raw/taxi_zone.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        FIRSTROW = 2,\n        FIELDTERMINATOR = ',',\n        ROWTERMINATOR = '\\n'\n)\nWITH(\n        location_id SMALLINT,\n        borough VARCHAR(15),\n        zone VARCHAR(50),\n        service_zone VARCHAR(15)\n    ) AS [result]\n\n-------------------------------\n--create external datasource\n\nCREATE EXTERNAL DATA SOURCE nyc_taxi_data\nWITH\n(\nlocation = 'abfss://nyc-taxi-data@bmksynapsedemodl.dfs.core.windows.net'\n)\n---------------------------------------------------------------\nCREATE EXTERNAL DATA SOURCE nyc_taxi_data_raw\nWITH\n(\nlocation = 'abfss://nyc-taxi-data@bmksynapsedemodl.dfs.core.windows.net/raw'\n)\n-----------------------------------------------------------------\n--selecting data without using complete address in buk statement--- \nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK 'taxi_zone.csv',\n        DATA_SOURCE = 'nyc_taxi_data_raw',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE\n    ) \n     WITH\n    (\n        location_id SMALLINT 1 ,\n        borough VARCHAR(15) 2,\n        zone VARCHAR(50) 3,\n        service_zone VARCHAR(15) 4\n    )\n    AS [result]\n----\nDROP EXTERNAL DATA SOURCE nyc_taxi_data;\n\nselect name, location from sys.external_data_sources;\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "nyc_taxi_discovery",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}