{
	"name": "4_create_bronzetables",
	"properties": {
		"folder": {
			"name": "nyc_taxi/ldw(logical datawarehouse)"
		},
		"content": {
			"query": "use nyc_taxi_ldw\n\n\nIF OBJECT_ID('bronze.taxi_zone') IS NOT NULL\n    DROP EXTERNAL TABLE bronze.taxi_zone\n\n            CREATE EXTERNAL TABLE bronze.taxi_zone\n                    (\n                        location_id SMALLINT,\n                        borough VARCHAR(15),\n                        zone VARCHAR(50),\n                        service_zone VARCHAR(15)\n                    )\n                    WITH(\n                        LOCATION = 'raw/taxi_zone.csv',\n                        DATA_SOURCE = nyc_taxi_src,\n                        FILE_FORMAT = csv_file_format_pv1,\n                        REJECT_VALUE = 10,\n                        REJECTED_ROW_LOCATION = 'rejections/taxi_zone'\n                        \n                    );\n\nSELECT * FROM bronze.taxi_zone;\n/*\n---all these external tables code can be created automatically by clicking on the file which we need to create the external table in datalake gen2 and ask the code it may look like this\nIF NOT EXISTS (SELECT * FROM sys.external_file_formats WHERE name = 'SynapseDelimitedTextFormat') \n\tCREATE EXTERNAL FILE FORMAT [SynapseDelimitedTextFormat] \n\tWITH ( FORMAT_TYPE = DELIMITEDTEXT ,\n\t       FORMAT_OPTIONS (\n\t\t\t FIELD_TERMINATOR = ',',\n\t\t\t FIRST_ROW = 11,\n\t\t\t USE_TYPE_DEFAULT = FALSE\n\t\t\t))\nGO\n\nIF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'nyc-taxi-data_bmksynapsedemodl_dfs_core_windows_net') \n\tCREATE EXTERNAL DATA SOURCE [nyc-taxi-data_bmksynapsedemodl_dfs_core_windows_net] \n\tWITH (\n\t\tLOCATION = 'abfss://nyc-taxi-data@bmksynapsedemodl.dfs.core.windows.net' \n\t)\nGO\n\nCREATE EXTERNAL TABLE bronze.taxi_zone (\n\t[LocationID] bigint,\n\t[Borough] nvarchar(4000),\n\t[Zone] nvarchar(4000),\n\t[service_zone] nvarchar(4000)\n\t)\n\tWITH (\n\tLOCATION = 'raw/taxi_zone.csv',\n\tDATA_SOURCE = [nyc-taxi-data_bmksynapsedemodl_dfs_core_windows_net],\n\tFILE_FORMAT = [SynapseDelimitedTextFormat]\n\t)\nGO\n\n\nSELECT TOP 100 * FROM bronze.taxi_zone\nGO\n*/\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "nyc_taxi_ldw",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}